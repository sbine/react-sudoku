var EventEmitter={eventRepository:{},dispatch:function(a,b){if(this.eventRepository[a])for(var c=0;c<this.eventRepository[a].length;c++)this.eventRepository[a][c](b)},subscribe:function(a,b){this.eventRepository[a]||(this.eventRepository[a]=[]),this.eventRepository[a].push(b)}},Puzzle=React.createClass({displayName:"Puzzle",getInitialState:function(){return{board:sudoku.generate(),cells:{},errored:[]}},componentDidMount:function(){EventEmitter.subscribe("validate",this.validatePuzzle),EventEmitter.subscribe("reset",this.resetPuzzle),this.createCellMatrix()},createCellMatrix:function(){var a=this.state.board,b={};for(i=65;i<=73;i++){var c=String.fromCharCode(i);for(j=1;j<=9;j++){var d=c+""+j;void 0!==a[d]?(b[d]={},b[d]=a[d]):b[d]=""}}return this.setState({cells:b}),b},getCells2D:function(){var a,b,c=_.values(this.state.cells),d=[],e=9;for(a=0,b=c.length;b>a;a+=e)d.push(c.slice(a,a+e));return d},updateCell:function(a,b){var c=this.state.cells,d=_.keys(c);c[d[a]]=b,this.setState({cells:c,errored:[]})},validatePuzzle:function(){var a=sudoku.getConflicts(this.state.cells),b=[];if(!a.length>0)return!0;_.each(a,function(a,c){_.each(a.errorFields,function(a,c){b.push(a)})});a[0].unit;this.setState({errored:b})},resetPuzzle:function(){this.replaceState(this.getInitialState(),function(){this.createCellMatrix()})},render:function(){var a=this,b=this.getCells2D(),c=_.keys(this.state.cells),d=-1;return React.createElement("table",null,React.createElement("tbody",null,_.map(b,function(b){return React.createElement("tr",null,_.map(b,function(b){d++;var e=!1,f=!1;return-1!==a.state.errored.indexOf(c[d])&&(e=!0),void 0!==a.state.board[c[d]]&&(f="readonly",b=a.state.board[c[d]]),React.createElement(Cell,{index:d,value:b,readonly:f,errored:e,updateHandler:a.updateCell})}))})))}}),Cell=React.createClass({displayName:"Cell",handleChange:function(a){var b=this.getDOMNode().firstChild.value;this.props.updateHandler(this.props.index,b)},render:function(){return React.createElement("td",null,React.createElement("input",{type:"text",value:this.props.value,onChange:this.handleChange,"data-errored":this.props.errored,className:"sudoku-cell",readOnly:this.props.readonly}))}}),ValidateButton=React.createClass({displayName:"ValidateButton",handleValidation:function(){EventEmitter.dispatch("validate")},render:function(){return React.createElement("button",{className:"sudoku-control",onClick:this.handleValidation},"Validate")}}),ResetButton=React.createClass({displayName:"ResetButton",handleReset:function(){EventEmitter.dispatch("reset")},render:function(){return React.createElement("button",{className:"sudoku-control",onClick:this.handleReset},"New Puzzle")}});React.render(React.createElement("div",null,React.createElement(Puzzle,null),React.createElement(ValidateButton,null),React.createElement(ResetButton,null)),document.getElementById("board"));